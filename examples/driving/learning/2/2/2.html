<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API Documentation</title>
    <link rel="stylesheet" href="http://121.184.63.113:4000/css/basic.css">
    <link rel="stylesheet" href="http://121.184.63.113:4000/css/default.min.css">
    <script src="http://121.184.63.113:4000/js/highlight.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
  </head>
  <body class="api-docs">
    <div class="container">
      
      <h1>장애물 감지 주행하기</h1>
      <hr>
      <h2 style="margin-bottom: 3px;">장애물 환경 구축하기</h2>
      <p> 자주차 앞에 차보다 큰 장애물을 설치합니다 </p>
      <div class="image-div">
        <img src="http://121.184.63.113:4000/images/drv_221.svg"  alt="Placeholder image" />
      </div>
      <p>*전보다 더 먼 거리에 장애물을 세팅합니다 </p>
    </div>  

    <div class="container">
      <hr>
      <h2 style="margin-bottom: 3px;">자주차, 넘파이 모듈 가져오기</h2>
      <p>자주차를 제어하기 위한 함수들의 모음집인 jajucha2 , numpy 라이브러리를 가져옵니다</p>
    </div>
    <div class="code"> 
      <h3>A를 실행하여 필요한 라이브러리들을 가져옵니다</h3>
      <p>자주차 라이브러리는 인공지능 기능을 포함 하고 있어 로딩하는데 2-3초 정도 소요됩니다</p>
      <p>numpy 라이브러리는 수학적인 계산을 위한 라이브러리 입니다</p>
      <div class="code_div">
        <pre>
          <code class="language-python">
import jajucha2
import numpy as np</code>
        </pre>
      </div>
      <br></br>
    </div >
    <div class="container">
      <hr>
      <h2 style="margin-bottom: 3px;">장애물 기반 주행하기</h2>
      <p>장애물과의 거리를 계산하면서 주행합니다</p>
    </div>
    <div class="code"> 
      <h3>B를 실행하여 주행을 시작합니다</h3>
      <div class="code_div">
        <pre>
          <code class="language-python">
while True:  # 무한 루프를 시작합니다.
  depth = jajucha2.camera.get_depth()  # jajucha2의 카메라에서 깊이 이미지를 가져옵니다.
  jajucha2.camera.show_image(depth, 'depth')  # 가져온 깊이 이미지를 'depth'라는 이름으로 화면에 표시합니다.

  # 깊이 이미지에서 가로(width)와 세로(height) 길이를 추출하여 정의합니다.
  height, width = depth.shape[:2]
  
  # 이미지의 중심 좌표를 설정합니다 (가로와 세로의 중간 지점).
  center_x, center_y = width // 2, height // 2

  # 추출할 영역의 크기를 정의합니다 (60x60 크기의 영역).
  region_size = 60

  # 추출할 60x60 영역의 좌상단 (왼쪽 상단) 좌표를 계산합니다.
  start_x = center_x - region_size // 2  # 중앙에서 사각형 크기의 절반만큼 왼쪽으로 이동.
  start_y = center_y - region_size // 2  # 중앙에서 사각형 크기의 절반만큼 위로 이동.

  # 이미지 중앙에서 60x60 크기의 영역을 추출합니다.
  center_region = depth[start_y:start_y + region_size, start_x:start_x + region_size]

  # 추출된 영역의 모든 픽셀 값의 평균을 계산합니다.
  mean_value = np.mean(center_region)

  # 출력된 값은 평균 밝기 값으로, 0-255 사이의 값을 가집니다.
  print(mean_value)

  # 만약 평균값이 100보다 작다면 (어두운 경우), 차량의 모터를 멈추고 경고음을 5초 동안 울립니다.
  if(mean_value < 100):
      jajucha2.control.set_motor(0, 0, 5)  # 좌, 우 모터 속도를 0으로 설정 (정지), 경고음 5초 재생.
  else:
      jajucha2.control.set_motor(0, 0, 0)  # 평균값이 100 이상일 경우, 차량 정지 및 경고음 없음.</code>
        </pre>
      </div>
      <br></br>
    </div >

  </body>
</html>
